plugins:
  source:
    - module: intake_postgres

sources:
  # In this case, each "source" is the name of a dataset; for convenience, it
  # shares the name of the table where the data resides - but this need not be
  # the case (and will probably not be the case very often).
  - name: sample1
    driver: postgres
    args:
      uri: 'postgresql://postgres@localhost:5432/postgres'
      sql_expr: 'select * from sample1'

  - name: sample2_1
    driver: postgres
    args:
      uri: 'postgresql://postgres@localhost:5432/postgres'
      sql_expr: 'select * from sample2_1'

  - name: sample2_2
    driver: postgres
    args:
      uri: 'postgresql://postgres@localhost:5432/postgres'
      sql_expr: 'select * from sample2_2'

  - name: sample2
    driver: postgres
    args:
      uri: 'postgresql://postgres@localhost:5432/postgres'
      sql_expr: |
        select coalesce(a.name, b.name) as name,
               coalesce(a.score, b.score) as score,
               coalesce(a.rank, b.rank) as rank
        from sample2_1 a full outer join sample2_2 b
        on a.name = b.name
